% Script generated by Brainstorm (10-Jan-2018)
%% PRELIMINARY PREPARATION
clear

%% ADD FUNCTIONS
addpath('/storages/LDATA/Giorgio/TDCS MEG Exp1 Graph Theory analysis/Scripts/functions')


%% GET CURRENT SCRIPT NAME

script_name = mfilename('fullpath')

if (length(script_name) == 0)
    error('You must run this script by calling it from the prompt or clicking the Run button!')
end

%%
% Input files
my_sFiles_ini = {...
    'Subject01_A/S001_ISRRestingEC_20170220_01_resample/timefreq_connectn_plv_180201_2010_pre.mat', ...
    'Subject01_A/S001_ISRRestingEC_20170220_02_resample/timefreq_connectn_plv_180201_2014_post.mat', ...
    'Subject01_B/TDCSS001_ISRRestingEC_20170221_01_resample/timefreq_connectn_plv_180201_2019_pre.mat', ...
    'Subject01_B/TDCSS001_ISRRestingEC_20170221_02_resample/timefreq_connectn_plv_180201_2024_post.mat', ...
    'Subject02_A/TDCSS002_ISRRestingEC_20170220_01_resample/timefreq_connectn_plv_180201_2029_pre.mat', ...
    'Subject02_A/TDCSS002_ISRRestingEC_20170220_02_resample/timefreq_connectn_plv_180201_2033_post.mat', ...
    'Subject02_B/TDCSS002_ISRRestingEC_20170220_03_resample/timefreq_connectn_plv_180201_2038_pre.mat', ...
    'Subject02_B/TDCSS002_ISRRestingEC_20170220_04_resample/timefreq_connectn_plv_180201_2043_post.mat', ...
    'Subject03_A/TDCSS003_ISRRestingEC_20170221_01_resample_02/timefreq_connectn_plv_180201_2048_pre.mat', ...
    'Subject03_A/TDCSS003_ISRRestingEC_20170221_02_resample_02/timefreq_connectn_plv_180201_2052_post.mat', ...
    'Subject03_B/TDCSS003_ISRRestingEC_20170222_01_resample_02/timefreq_connectn_plv_180201_2058_pre.mat', ...
    'Subject03_B/TDCSS003_ISRRestingEC_20170222_02_resample_02/timefreq_connectn_plv_180201_2103_post.mat', ...
    'Subject04_A/TDCSS004_ISRRestingEC_20170222_01_resample_02/timefreq_connectn_plv_180201_2108_pre.mat', ...
    'Subject04_A/TDCSS004_ISRRestingEC_20170222_02_resample_02/timefreq_connectn_plv_180201_2114_post.mat', ...
    'Subject04_B/TDCSS004_ISRRestingEC_20170222_03_resample_02/timefreq_connectn_plv_180201_2119_pre.mat', ...
    'Subject04_B/TDCSS004_ISRRestingEC_20170222_04_resample/timefreq_connectn_plv_180201_2123_post.mat', ...
    'Subject05_A/TDCSS005_ISRRestingEC_20170228_01_resample/timefreq_connectn_plv_180201_2128_pre.mat', ...
    'Subject05_A/TDCSS005_ISRRestingEC_20170228_02_resample/timefreq_connectn_plv_180201_2132_post.mat', ...
    'Subject05_B/TDCSS005_ISRRestingEC_20170301_01_resample/timefreq_connectn_plv_180201_2136_pre.mat', ...
    'Subject05_B/TDCSS005_ISRRestingEC_20170301_02_resample/timefreq_connectn_plv_180201_2141_post.mat', ...
    'Subject06_A/TDCSS006_ISRRestingEC_20170223_01_resample/timefreq_connectn_plv_180201_2146_pre.mat', ...
    'Subject06_A/TDCSS006_ISRRestingEC_20170223_02_resample/timefreq_connectn_plv_180201_2151_post.mat', ...
    'Subject06_B/TDCSS006_ISRRestingEC_20170228_01_resample/timefreq_connectn_plv_180201_2156_pre.mat', ...
    'Subject06_B/TDCSS006_ISRRestingEC_20170228_02_resample/timefreq_connectn_plv_180201_2202_post.mat', ...
    'Subject07_A/TDCSS007_ISRRestingEC_20170227_01_resample/timefreq_connectn_plv_180201_2207_pre.mat', ...
    'Subject07_A/TDCSS007_ISRRestingEC_20170227_02_resample/timefreq_connectn_plv_180201_2212_post.mat', ...
    'Subject07_B/TDCSS007_ISRRestingEC_20170303_01_resample/timefreq_connectn_plv_180201_2217_pre.mat', ...
    'Subject07_B/TDCSS007_ISRRestingEC_20170303_02_resample/timefreq_connectn_plv_180201_2222_post.mat', ...
    'Subject08_A/TDCSS008_ISRRestingEC_20170227_01_resample/timefreq_connectn_plv_180201_2227_pre.mat', ...
    'Subject08_A/TDCSS008_ISRRestingEC_20170227_02_resample/timefreq_connectn_plv_180201_2233_post.mat', ...
    'Subject08_B/TDCSS008_ISRRestingEC_20170227_03_resample/timefreq_connectn_plv_180201_2238_pre.mat', ...
    'Subject08_B/TDCSS008_ISRRestingEC_20170227_04_resample/timefreq_connectn_plv_180201_2244_post.mat', ...
    'Subject09_A/TDCSS009_ISRRestingEC_20170227_01_resample/timefreq_connectn_plv_180201_2249_pre.mat', ...
    'Subject09_A/TDCSS009_ISRRestingEC_20170227_02_resample/timefreq_connectn_plv_180201_2255_post.mat', ...
    'Subject09_B/TDCSS009_ISRRestingEC_20170302_01_resample/timefreq_connectn_plv_180201_2300_pre.mat', ...
    'Subject09_B/TDCSS009_ISRRestingEC_20170302_02_resample/timefreq_connectn_plv_180201_2306_post.mat', ...
    'Subject10_A/TDCSS010_ISRRestingEC_20170228_01_resample/timefreq_connectn_plv_180201_2311_pre.mat', ...
    'Subject10_A/TDCSS010_ISRRestingEC_20170228_02_resample/timefreq_connectn_plv_180201_2316_post.mat', ...
    'Subject10_B/TDCSS010_ISRRestingEC_20170420_01_resample/timefreq_connectn_plv_180201_2321_pre.mat', ...
    'Subject10_B/TDCSS010_ISRRestingEC_20170420_02_resample/timefreq_connectn_plv_180201_2326_post.mat', ...
    'Subject11_A/TDCSS011_ISRRestingEC_20170301_01_resample/timefreq_connectn_plv_180201_2332_pre.mat', ...
    'Subject11_A/TDCSS011_ISRRestingEC_20170301_02_resample/timefreq_connectn_plv_180201_2337_post.mat', ...
    'Subject11_B/TDCSS011_ISRRestingEC_20170306_01_resample/timefreq_connectn_plv_180201_2343_pre.mat', ...
    'Subject11_B/TDCSS011_ISRRestingEC_20170306_02_resample/timefreq_connectn_plv_180201_2348_post.mat', ...
    'Subject12_A/TDCSS012_ISRRestingEC_20170410_01_resample/timefreq_connectn_plv_180201_2353_pre.mat', ...
    'Subject12_A/TDCSS012_ISRRestingEC_20170410_02_resample/timefreq_connectn_plv_180201_2359_post.mat', ...
    'Subject12_B/TDCSS012_ISRRestingEC_20170411_01_resample/timefreq_connectn_plv_180202_0004_pre.mat', ...
    'Subject12_B/TDCSS012_ISRRestingEC_20170411_02_resample/timefreq_connectn_plv_180202_0010_post.mat', ...
    'Subject13_A/TDCSS013_ISRRestingEC_20170411_01_resample/timefreq_connectn_plv_180202_0015_pre.mat', ...
    'Subject13_A/TDCSS013_ISRRestingEC_20170411_02_resample/timefreq_connectn_plv_180202_0020_post.mat', ...
    'Subject13_B/TDCSS013_ISRRestingEC_20170412_01_resample/timefreq_connectn_plv_180202_0025_pre.mat', ...
    'Subject13_B/TDCSS013_ISRRestingEC_20170412_02_resample/timefreq_connectn_plv_180202_0031_post.mat', ...
    'Subject14_A/TDCSS014_ISRRestingEC_20170420_01_resample/timefreq_connectn_plv_180202_0036_pre.mat', ...
    'Subject14_A/TDCSS014_ISRRestingEC_20170420_02_resample/timefreq_connectn_plv_180202_0042_post.mat', ...
    'Subject14_B/TDCSS014_ISRRestingEC_20170421_01_resample/timefreq_connectn_plv_180202_0047_pre.mat', ...
    'Subject14_B/TDCSS014_ISRRestingEC_20170421_02_resample/timefreq_connectn_plv_180202_0052_post.mat', ...
    'Subject15_A/TDCSS015_ISRRestingEC_20170424_01_resample/timefreq_connectn_plv_180202_0058_pre.mat', ...
    'Subject15_A/TDCSS015_ISRRestingEC_20170424_02_resample/timefreq_connectn_plv_180202_0103_post.mat', ...
    'Subject15_B/TDCSS015_ISRRestingEC_20170426_01_resample/timefreq_connectn_plv_180202_0109_pre.mat', ...
    'Subject15_B/TDCSS015_ISRRestingEC_20170426_02_resample/timefreq_connectn_plv_180202_0114_post.mat'};


sFiles = my_sFiles_ini;

cd('/storages/LDATA/Giorgio/TDCS MEG Exp1 Graph Theory analysis/Conn_mat')
% Start a new report
bst_report('Start', sFiles);

% Process: export connectivity matrix in .mat format
sFiles = bst_process('CallProcess', 'process_export_conn_mat', sFiles, [], ...
    'chars',        50, ...
    'base',         '', ...
    'BaseOver',     0, ...
    'Num',          1);

% Save and display report
ReportFile = bst_report('Save', sFiles);
bst_report('Open', ReportFile);
% bst_report('Export', ReportFile, ExportDir);


script_name = mfilename('fullpath')

if (length(script_name) == 0)
    error('You must run this script by calling it from the prompt or clicking the Run button!')
end

export_script(script_name, my_sFiles_ini)

