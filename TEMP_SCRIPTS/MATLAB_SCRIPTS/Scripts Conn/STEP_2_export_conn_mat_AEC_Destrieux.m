% Script generated by Brainstorm (10-Jan-2018)
%% PRELIMINARY PREPARATION
clear

%% ADD FUNCTIONS
addpath('/storages/LDATA/Giorgio/TDCS MEG Exp1 Graph Theory analysis/Scripts/functions')


%% GET CURRENT SCRIPT NAME

script_name = mfilename('fullpath')

if (length(script_name) == 0)
    error('You must run this script by calling it from the prompt or clicking the Run button!')
end

%%
% Input files
my_sFiles_ini = {...
    'Subject01_A/S001_ISRRestingEC_20170220_01_resample/timefreq_connectn_aec_180214_1116_pre_Destrieux.mat', ...
    'Subject01_A/S001_ISRRestingEC_20170220_02_resample/timefreq_connectn_aec_180214_1128_post_Destrieux.mat', ...
    'Subject01_B/TDCSS001_ISRRestingEC_20170221_01_resample/timefreq_connectn_aec_180214_1140_pre_Destrieux.mat', ...
    'Subject01_B/TDCSS001_ISRRestingEC_20170221_02_resample/timefreq_connectn_aec_180214_1152_post_Destrieux.mat', ...
    'Subject02_A/TDCSS002_ISRRestingEC_20170220_01_resample/timefreq_connectn_aec_180214_1205_pre_Destrieux.mat', ...
    'Subject02_A/TDCSS002_ISRRestingEC_20170220_02_resample/timefreq_connectn_aec_180214_1217_post_Destrieux.mat', ...
    'Subject02_B/TDCSS002_ISRRestingEC_20170220_03_resample/timefreq_connectn_aec_180214_1229_pre_Destrieux.mat', ...
    'Subject02_B/TDCSS002_ISRRestingEC_20170220_04_resample/timefreq_connectn_aec_180214_1242_post_Destrieux.mat', ...
    'Subject04_A/TDCSS004_ISRRestingEC_20170222_01_resample_02/timefreq_connectn_aec_180214_1256_pre_Destrieux.mat', ...
    'Subject04_A/TDCSS004_ISRRestingEC_20170222_02_resample_02/timefreq_connectn_aec_180214_1309_post_Destrieux.mat', ...
    'Subject04_B/TDCSS004_ISRRestingEC_20170222_03_resample_02/timefreq_connectn_aec_180214_1321_pre_Destrieux.mat', ...
    'Subject04_B/TDCSS004_ISRRestingEC_20170222_04_resample/timefreq_connectn_aec_180214_1334_post_Destrieux.mat', ...
    'Subject05_A/TDCSS005_ISRRestingEC_20170228_01_resample/timefreq_connectn_aec_180214_1346_pre_Destrieux.mat', ...
    'Subject05_A/TDCSS005_ISRRestingEC_20170228_02_resample/timefreq_connectn_aec_180214_1355_post_Destrieux.mat', ...
    'Subject05_B/TDCSS005_ISRRestingEC_20170301_01_resample/timefreq_connectn_aec_180214_1408_pre_Destrieux.mat', ...
    'Subject05_B/TDCSS005_ISRRestingEC_20170301_02_resample/timefreq_connectn_aec_180214_1420_post_Destrieux.mat', ...
    'Subject06_A/TDCSS006_ISRRestingEC_20170223_01_resample/timefreq_connectn_aec_180214_1432_pre_Destrieux.mat', ...
    'Subject06_A/TDCSS006_ISRRestingEC_20170223_02_resample/timefreq_connectn_aec_180214_1445_post_Destrieux.mat', ...
    'Subject06_B/TDCSS006_ISRRestingEC_20170228_01_resample/timefreq_connectn_aec_180214_1458_pre_Destrieux.mat', ...
    'Subject06_B/TDCSS006_ISRRestingEC_20170228_02_resample/timefreq_connectn_aec_180214_1511_post_Destrieux.mat', ...
    'Subject07_A/TDCSS007_ISRRestingEC_20170227_01_resample/timefreq_connectn_aec_180214_1524_pre_Destrieux.mat', ...
    'Subject07_A/TDCSS007_ISRRestingEC_20170227_02_resample/timefreq_connectn_aec_180214_1536_post_Destrieux.mat', ...
    'Subject07_B/TDCSS007_ISRRestingEC_20170303_01_resample/timefreq_connectn_aec_180214_1549_pre_Destrieux.mat', ...
    'Subject07_B/TDCSS007_ISRRestingEC_20170303_02_resample/timefreq_connectn_aec_180214_1601_post_Destrieux.mat', ...
    'Subject08_A/TDCSS008_ISRRestingEC_20170227_01_resample/timefreq_connectn_aec_180214_1613_pre_Destrieux.mat', ...
    'Subject08_A/TDCSS008_ISRRestingEC_20170227_02_resample/timefreq_connectn_aec_180214_1626_post_Destrieux.mat', ...
    'Subject08_B/TDCSS008_ISRRestingEC_20170227_03_resample/timefreq_connectn_aec_180214_1638_pre_Destrieux.mat', ...
    'Subject08_B/TDCSS008_ISRRestingEC_20170227_04_resample/timefreq_connectn_aec_180214_1650_post_Destrieux.mat', ...
    'Subject09_A/TDCSS009_ISRRestingEC_20170227_01_resample/timefreq_connectn_aec_180214_1701_pre_Destrieux.mat', ...
    'Subject09_A/TDCSS009_ISRRestingEC_20170227_02_resample/timefreq_connectn_aec_180214_1713_post_Destrieux.mat', ...
    'Subject09_B/TDCSS009_ISRRestingEC_20170302_01_resample/timefreq_connectn_aec_180214_1726_pre_Destrieux.mat', ...
    'Subject09_B/TDCSS009_ISRRestingEC_20170302_02_resample/timefreq_connectn_aec_180214_1737_post_Destrieux.mat', ...
    'Subject10_A/TDCSS010_ISRRestingEC_20170228_01_resample/timefreq_connectn_aec_180214_1749_pre_Destrieux.mat', ...
    'Subject10_A/TDCSS010_ISRRestingEC_20170228_02_resample/timefreq_connectn_aec_180214_1801_post_Destrieux.mat', ...
    'Subject10_B/TDCSS010_ISRRestingEC_20170420_01_resample/timefreq_connectn_aec_180214_1813_pre_Destrieux.mat', ...
    'Subject10_B/TDCSS010_ISRRestingEC_20170420_02_resample/timefreq_connectn_aec_180214_1825_post_Destrieux.mat', ...
    'Subject11_A/TDCSS011_ISRRestingEC_20170301_01_resample/timefreq_connectn_aec_180214_1838_pre_Destrieux.mat', ...
    'Subject11_A/TDCSS011_ISRRestingEC_20170301_02_resample/timefreq_connectn_aec_180214_1850_post_Destrieux.mat', ...
    'Subject11_B/TDCSS011_ISRRestingEC_20170306_01_resample/timefreq_connectn_aec_180214_1903_pre_Destrieux.mat', ...
    'Subject11_B/TDCSS011_ISRRestingEC_20170306_02_resample/timefreq_connectn_aec_180214_1913_post_Destrieux.mat', ...
    'Subject12_A/TDCSS012_ISRRestingEC_20170410_01_resample/timefreq_connectn_aec_180214_1925_pre_Destrieux.mat', ...
    'Subject12_A/TDCSS012_ISRRestingEC_20170410_02_resample/timefreq_connectn_aec_180214_1937_post_Destrieux.mat', ...
    'Subject12_B/TDCSS012_ISRRestingEC_20170411_01_resample/timefreq_connectn_aec_180214_1950_pre_Destrieux.mat', ...
    'Subject12_B/TDCSS012_ISRRestingEC_20170411_02_resample/timefreq_connectn_aec_180214_2002_post_Destrieux.mat', ...
    'Subject13_A/TDCSS013_ISRRestingEC_20170411_01_resample/timefreq_connectn_aec_180214_2014_pre_Destrieux.mat', ...
    'Subject13_A/TDCSS013_ISRRestingEC_20170411_02_resample/timefreq_connectn_aec_180214_2026_post_Destrieux.mat', ...
    'Subject13_B/TDCSS013_ISRRestingEC_20170412_01_resample/timefreq_connectn_aec_180214_2038_pre_Destrieux.mat', ...
    'Subject13_B/TDCSS013_ISRRestingEC_20170412_02_resample/timefreq_connectn_aec_180214_2051_post_Destrieux.mat', ...
    'Subject14_A/TDCSS014_ISRRestingEC_20170420_01_resample/timefreq_connectn_aec_180214_2103_pre_Destrieux.mat', ...
    'Subject14_A/TDCSS014_ISRRestingEC_20170420_02_resample/timefreq_connectn_aec_180214_2116_post_Destrieux.mat', ...
    'Subject14_B/TDCSS014_ISRRestingEC_20170421_01_resample/timefreq_connectn_aec_180214_2128_pre_Destrieux.mat', ...
    'Subject14_B/TDCSS014_ISRRestingEC_20170421_02_resample/timefreq_connectn_aec_180214_2140_post_Destrieux.mat', ...
    'Subject15_A/TDCSS015_ISRRestingEC_20170424_01_resample/timefreq_connectn_aec_180214_2151_pre_Destrieux.mat', ...
    'Subject15_A/TDCSS015_ISRRestingEC_20170424_02_resample/timefreq_connectn_aec_180214_2203_post_Destrieux.mat', ...
    'Subject15_B/TDCSS015_ISRRestingEC_20170426_01_resample/timefreq_connectn_aec_180214_2216_pre_Destrieux.mat', ...
    'Subject15_B/TDCSS015_ISRRestingEC_20170426_02_resample/timefreq_connectn_aec_180214_2227_post_Destrieux.mat'};



sFiles = my_sFiles_ini;

cd('/storages/LDATA/Giorgio/TDCS MEG Exp1 Graph Theory analysis/Conn_mat')
% Start a new report
bst_report('Start', sFiles);

% Process: export connectivity matrix in .mat format
sFiles = bst_process('CallProcess', 'process_export_conn_mat', sFiles, [], ...
    'chars',        50, ...
    'base',         '', ...
    'BaseOver',     0, ...
    'Num',          1);

% Save and display report
ReportFile = bst_report('Save', sFiles);
bst_report('Open', ReportFile);
% bst_report('Export', ReportFile, ExportDir);


script_name = mfilename('fullpath')

if (length(script_name) == 0)
    error('You must run this script by calling it from the prompt or clicking the Run button!')
end

export_script(script_name, my_sFiles_ini)

